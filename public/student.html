<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Homepage | UR'Plan</title>
    <!--Setting the core Bootstrap CSS-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous"> 
    <link href="student.css" rel="stylesheet">
</head>
<body class="text-center">    
    <div id="myResourcesNav" class="leftsidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeResourcesNav()">&times;</a>
        <p-big>Resources</p-big><br>
        <a href="https://student.engr.ucr.edu/majors">Recommended Course Plans</a>
        <a href="https://www1.cs.ucr.edu/undergraduate/course-listings/">Course Offerings</a>
        <a href="http://studentbcoe.ucr.acsitefactory.com/sites/g/files/rcwecm1536/files/2019-06/Breadth%20Requirements%206.12.19.pdf">Breadth Courses</a>
        <a href="https://degreeworks.ucr.edu/dashboard/dashboard">Degree Audit</a>
    </div>

    <div id="myPreferencesNav" class="rightsidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closePreferencesNav()">&times;</a>
        <p-big>Preferences</p-big><br>
        
        <p>Days</p>
        <form>
            <input type="checkbox" id="monday" name="monday" value="M">
            <label for="monday">Monday</label><br>
            <input type="checkbox" id="tuesday" name="tuesday" value="T">
            <label for="tuesday">Tuesday</label><br>
            <input type="checkbox" id="wednesday" name="wednesday" value="W">
            <label for="wednesday">Wednesday</label><br>
            <input type="checkbox" id="thursday" name="thursday" value="R">
            <label for="thursday">Thursday</label><br>
            <input type="checkbox" id="friday" name="friday" value="F">
            <label for="friday">Friday</label><br>
        </form> 
        
        <p>Time</p>
        <form> 
            <label for="startTime">Starting Time: </label>
            <input type="time" id="startTime" value="07:00"><br>
            <label for="endTime">Ending Time: </label>
            <input type="time" id="endTime" value="22:00"><br>
        </form>
        
        <p>Number of Classes</p>
        <form> <!--action="/action_page.php"-->
            <label for="quantity">Quantity: </label>
            <input type="number" id="quantity" name="quantity" min="1" max="5" value="4"><br><br><br>
        </form>

        <input type="submit" value="Generate my Term Plan!">
    </div>

    <!-- Add all page content inside this div if you want the side nav to push page content to the right (not used if you only want the sidenav to sit on top of the page -->
    <div id="main">
        <h1 class="h3 mb-3 font-weight-normal" id="welcome"></h1>
        <button class="btn btn-secondary" type="submit" onclick="openResourcesNav()">Resources</button>
        <button class="btn btn-secondary" type="submit" onclick="openPreferencesNav()">Preferences</button>
        <button class="btn btn-secondary" type="submit" id="signoutButton">Sign Out</button>
        <iframe id="calendar" src="" style="border-width:0" width="100%" height="600" frameborder="0" scrolling="no"></iframe>
    </div>
    
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.10.0/firebase-auth.js"></script>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyAITqYy9_z2PlI_MICO1Ob-Ay18mWx6qmk",
            authDomain: "ur-plan.firebaseapp.com",
            databaseURL: "https://ur-plan.firebaseio.com",
            projectId: "ur-plan",
            storageBucket: "ur-plan.appspot.com",
            messagingSenderId: "893010591089",
            appId: "1:893010591089:web:c039574c91b33876768ad0",
            measurementId: "G-HRDWGFW0QW",
        };
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();

        firebase.auth().onAuthStateChanged(function(user) {            
            if(user) {
                var pre = document.getElementById('welcome');
                var textContent = document.createTextNode('Welcome ' + firebase.auth().currentUser.displayName + '!\n');
                pre.prepend(textContent);
            }
        });
    </script>

    <script async defer src="https://apis.google.com/js/api.js"
        onload="this.onload=function(){};handleClientLoad()"
        onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>

    <script>
        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: "AIzaSyDz0gR_sgfUeTuXEfkCn5t79qYhBO1hakI",
                clientId: "302327930081-ijcupmhamhanidi156eh0gmjq4idr650.apps.googleusercontent.com",
                discoveryDocs: [
                    "https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest",
                ],
                scope: "https://www.googleapis.com/auth/calendar"
            }).then(function () {
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
                signoutButton.onclick = handleSignOut;
            }, function(error) {
                appendPre(JSON.stringify(error, null, 2));
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                embedCalendars();
            } else {
                //do nothing for now.
            }
        }

        function handleSignOut(event) {
            gapi.auth2.getAuthInstance().signOut();
            firebase.auth().signOut().then(function() {
                location.assign("index.html");
            }).catch(function(error) {
                location.assign("404.html");
            });
        }
    
    </script>

    <script>
        /* Set the width of the side navigation to 250px and the left margin of the page content to 250px */
        function openResourcesNav() {
            document.getElementById("myResourcesNav").style.width = "250px";
            document.getElementById("main").style.marginLeft = "250px";
        }

        function closeResourcesNav() {
            document.getElementById("myResourcesNav").style.width = "0";
            document.getElementById("main").style.marginLeft = "0";
        }

        function openPreferencesNav() {
            document.getElementById("myPreferencesNav").style.width = "250px";
            document.getElementById("main").style.marginRight = "250px";
        }

        function closePreferencesNav() {
            document.getElementById("myPreferencesNav").style.width = "0";
            document.getElementById("main").style.marginRight = "0";
        }

        function embedCalendars() {            
            var calendarIdsString = "";
            
            gapi.client.calendar.calendarList.list({
                // use default parameters
            }).then(function(response) {
                var calendars = response.result.items;
                if (calendars.length > 0) { 
                    for (i = 0; i < calendars.length; i++) {
                        var calendar = calendars[i];
                        calendarIdsString += "&src=" + calendar.id + "&amp;";
                    }
                } else {
                    // do nothing for now.
                }
                document.getElementById("calendar").src = "https://www.google.com/calendar/embed?" + calendarIdsString + "&ctz=America%2FLosAngeles&amp;&mode=WEEK"; //colors?
            });
        }
              
        
    </script>

</body>
</html>